# Plan 08-02: Backfill Actor Attribution in Existing Records

## Metadata

```yaml
plan_id: "08-02"
phase: 8
wave: 1
depends_on: ["08-01"]
files_modified:
  - orchestrator/src/lib/migrations/backfill-actors.ts
  - orchestrator/src/app/api/admin/migrate/route.ts
autonomous: true
estimated_duration: "15 minutes"
```

## Goal

Backfill actor attribution in stage transition events and activity logs for records created before the multi-user system was implemented.

## Tasks

### Task 1: Create backfill function

**File**: `orchestrator/src/lib/migrations/backfill-actors.ts`

Create a function that:
- Finds stage transition events with "user" as actor
- Updates them to reference the workspace admin
- Creates initial activity log entries for existing projects
- Is idempotent

**Acceptance Criteria**:
- [ ] Updates stage_transition_events with proper user IDs
- [ ] Creates activity entries for existing projects
- [ ] Is idempotent (safe to run multiple times)

### Task 2: Add backfill to migration endpoint

**File**: `orchestrator/src/app/api/admin/migrate/route.ts`

Add backfill function to the migration endpoint.

**Acceptance Criteria**:
- [ ] Migration endpoint runs both workspace assignment and actor backfill
- [ ] Returns combined results
