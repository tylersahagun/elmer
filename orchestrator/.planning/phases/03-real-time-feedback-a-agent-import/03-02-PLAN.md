---
phase: 03-real-time-feedback-a-agent-import
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/discovery/AgentPreview.tsx
  - src/components/discovery/AgentItem.tsx
  - src/components/discovery/index.ts
autonomous: true

must_haves:
  truths:
    - "User sees detected agents grouped by type in preview"
    - "Each agent shows name, type badge, and source path"
    - "User can see which commands, skills, rules, and AGENTS.md are detected"
  artifacts:
    - path: "src/components/discovery/AgentPreview.tsx"
      provides: "Agent preview section in discovery UI"
      exports: ["AgentPreview"]
    - path: "src/components/discovery/AgentItem.tsx"
      provides: "Individual agent item display"
      exports: ["AgentItem"]
  key_links:
    - from: "src/components/discovery/AgentPreview.tsx"
      to: "src/lib/discovery/types.ts"
      via: "uses DiscoveredAgent type"
      pattern: "import.*DiscoveredAgent"
---

<objective>
Create agent preview UI components for discovery step

Purpose: Display detected .cursor/ commands and agents in preview before import (PREV-04, AGENT-01 through AGENT-04)
Output: React components for viewing discovered agent definitions
</objective>

<execution_context>
@/Users/tylersahagun/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tylersahagun/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-structure-discovery-a-workspace-population/02-04-SUMMARY.md

Reference existing discovery components:
@src/components/discovery/DiscoveryPreview.tsx
@src/components/discovery/InitiativeItem.tsx
@src/lib/discovery/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AgentItem component</name>
  <files>
    src/components/discovery/AgentItem.tsx
  </files>
  <action>
Create `src/components/discovery/AgentItem.tsx` following the pattern from InitiativeItem:

```typescript
"use client";

import { Checkbox } from "@/components/ui/checkbox";
import { Badge } from "@/components/ui/badge";
import { FileCode, Bot, Zap, ScrollText, BookOpen } from "lucide-react";
import type { DiscoveredAgent } from "@/lib/discovery/types";

interface AgentItemProps {
  agent: DiscoveredAgent;
  isSelected: boolean;
  onToggle: (path: string) => void;
  showCheckbox?: boolean;
}
```

Component should display:
1. Checkbox (optional, controlled by showCheckbox prop)
2. Icon based on type:
   - `agents_md` -> BookOpen
   - `skill` -> Zap
   - `command` -> FileCode
   - `subagent` -> Bot
   - `rule` -> ScrollText
3. Agent name (bold)
4. Type badge (colored):
   - `agents_md` -> purple "AGENTS.md"
   - `skill` -> blue "Skill"
   - `command` -> green "Command"
   - `subagent` -> orange "Subagent"
   - `rule` -> gray "Rule"
5. Source path in muted text
6. Description (if available) below name

Style with Tailwind:
- Hover state with subtle background
- Flex layout with items-start
- Proper spacing (gap-3)
- Text truncation for long paths
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit src/components/discovery/AgentItem.tsx`</verify>
  <done>AgentItem component exists, renders agent with type icon and badge</done>
</task>

<task type="auto">
  <name>Task 2: Create AgentPreview component</name>
  <files>
    src/components/discovery/AgentPreview.tsx
  </files>
  <action>
Create `src/components/discovery/AgentPreview.tsx`:

```typescript
"use client";

import { Bot } from "lucide-react";
import { AgentItem } from "./AgentItem";
import type { DiscoveredAgent } from "@/lib/discovery/types";

interface AgentPreviewProps {
  agents: DiscoveredAgent[];
  selectedPaths: Set<string>;
  onToggleAgent: (path: string) => void;
  showCheckboxes?: boolean;
}
```

Component should:
1. Show header "Agent Architecture" with Bot icon and count badge
2. Group agents by type using a Map:
   - Order: agents_md first, then skills, commands, subagents, rules
3. For each group, show:
   - Section header with type name and count
   - List of AgentItem components
4. Handle empty state: "No agent architecture detected"
5. Collapsible sections (use Radix Collapsible or Disclosure pattern)

Group display order and labels:
```typescript
const TYPE_ORDER: Array<{ type: DiscoveredAgent['type']; label: string }> = [
  { type: 'agents_md', label: 'AGENTS.md' },
  { type: 'skill', label: 'Skills' },
  { type: 'command', label: 'Commands' },
  { type: 'subagent', label: 'Subagents' },
  { type: 'rule', label: 'Rules' },
];
```

Style to match existing discovery preview sections.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit src/components/discovery/AgentPreview.tsx`</verify>
  <done>AgentPreview groups agents by type, shows counts, renders AgentItem list</done>
</task>

<task type="auto">
  <name>Task 3: Export and integrate into discovery barrel</name>
  <files>
    src/components/discovery/index.ts
  </files>
  <action>
Update `src/components/discovery/index.ts` to export new components:

```typescript
export { AgentItem } from './AgentItem';
export { AgentPreview } from './AgentPreview';
```

Verify existing exports are preserved (DiscoveryPreview, InitiativeItem, etc.)
  </action>
  <verify>
Import works: `node -e "require('./src/components/discovery/index.ts')"` via tsx
Or verify via build: `npm run build`
  </verify>
  <done>AgentPreview and AgentItem exported from discovery components barrel</done>
</task>

</tasks>

<verification>
- [ ] TypeScript compiles without errors: `npx tsc --noEmit`
- [ ] AgentItem renders with correct icon for each type
- [ ] AgentPreview groups agents correctly
- [ ] Components exported from barrel file
</verification>

<success_criteria>
1. AgentItem shows icon, name, type badge, and path
2. AgentPreview groups agents by type in correct order
3. Empty state handled gracefully
4. Components follow existing discovery UI patterns
5. Checkbox selection works (to be wired in later plan)
</success_criteria>

<output>
After completion, create `.planning/phases/03-real-time-feedback-a-agent-import/03-02-SUMMARY.md`
</output>
