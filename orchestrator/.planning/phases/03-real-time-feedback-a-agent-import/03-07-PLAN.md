---
phase: 03-real-time-feedback-a-agent-import
plan: 07
type: execute
wave: 4
depends_on: ["03-05", "03-06"]
files_modified:
  - src/components/onboarding/ImportProgressModal.tsx
  - src/components/onboarding/steps/DiscoveryStep.tsx
autonomous: false

must_haves:
  truths:
    - "User sees streaming progress during discovery"
    - "User can cancel discovery with feedback"
    - "User sees agent preview with selection"
    - "Imported agents are ready to execute"
  artifacts: []
  key_links: []
---

<objective>
End-to-end verification of Phase 3 features

Purpose: Verify all FEED-XX and AGENT-XX requirements are working together
Output: Confirmed working real-time feedback and agent import functionality
</objective>

<execution_context>
@/Users/tylersahagun/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tylersahagun/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-real-time-feedback-a-agent-import/03-05-SUMMARY.md
@.planning/phases/03-real-time-feedback-a-agent-import/03-06-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update import progress modal to show agent count</name>
  <files>
    src/components/onboarding/ImportProgressModal.tsx
  </files>
  <action>
Update `src/components/onboarding/ImportProgressModal.tsx` to display agent import results:

1. Add agents to result display:
```tsx
{result.agentsImported > 0 && (
  <div className="flex items-center gap-2">
    <Bot className="h-4 w-4 text-muted-foreground" />
    <span>{result.agentsImported} agents imported</span>
  </div>
)}
```

2. Update success message to reflect agents:
```tsx
const successMessage = () => {
  const parts = [];
  if (result.projectsCreated > 0) parts.push(`${result.projectsCreated} projects`);
  if (result.agentsImported > 0) parts.push(`${result.agentsImported} agents`);
  if (result.knowledgeSynced > 0) parts.push(`${result.knowledgeSynced} knowledge docs`);
  return parts.length > 0
    ? `Successfully imported ${parts.join(', ')}`
    : 'Import complete';
};
```

3. Import Bot icon from lucide-react
  </action>
  <verify>TypeScript compiles, modal shows agent count when agents imported</verify>
  <done>Import modal displays agent import results</done>
</task>

<task type="auto">
  <name>Task 2: Run all Phase 3 tests</name>
  <files>
    (test verification only)
  </files>
  <action>
Run complete test suite for Phase 3 components:

```bash
# All discovery tests
npm test -- src/lib/discovery/__tests__/

# All hooks tests
npm test -- src/hooks/

# Full test suite
npm test
```

Fix any failing tests from Phase 3 changes.
  </action>
  <verify>All tests pass: `npm test` exits with 0</verify>
  <done>All tests pass including new Phase 3 tests</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 3 implementation:
- Streaming discovery with SSE progress updates
- Live folder scanning progress ("Analyzing folder 23 of 50")
- Incremental item discovery (items appear as found)
- Elapsed and estimated time display
- Cancel button for long operations
- Agent preview with type grouping
- Agent selection controls
- Agent import to database
  </what-built>
  <how-to-verify>
1. Start dev server: `npm run dev`
2. Create a new workspace or use existing
3. Navigate to onboarding wizard discovery step
4. Connect to a repository with:
   - Multiple initiatives (for progress visibility)
   - .cursor/ directory or AGENTS.md (for agent detection)

5. VERIFY STREAMING PROGRESS (FEED-01, FEED-05):
   - Progress bar appears immediately on scan start
   - Folder count updates in real-time
   - Current folder name shown
   - Progress percentage updates smoothly

6. VERIFY INCREMENTAL DISCOVERY (FEED-02):
   - "Found so far" text shows items as discovered
   - Items appear before scan completes

7. VERIFY TIMING (FEED-03):
   - Elapsed time counter increments
   - Estimated remaining time shows after initial progress

8. VERIFY CANCEL (FEED-04):
   - Click Cancel button during scan
   - Scan stops, UI shows partial results or restart option

9. VERIFY AGENT PREVIEW (AGENT-01 through AGENT-05):
   - "Agent Architecture" section appears when agents found
   - Agents grouped by type (AGENTS.md, Skills, Commands, Rules)
   - Each agent shows icon, name, type badge, path
   - Checkboxes allow selection/deselection
   - Select all/none buttons work

10. VERIFY AGENT IMPORT (AGENT-06):
    - Select some agents, deselect others
    - Click Import button
    - Import modal shows progress
    - Success message includes agent count
    - Check database: agents exist with correct workspaceId
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues found</resume-signal>
</task>

</tasks>

<verification>
- [ ] All tests pass
- [ ] Streaming progress shows during discovery
- [ ] Cancel button stops discovery
- [ ] Elapsed and estimated time display correctly
- [ ] Agent preview shows detected agents by type
- [ ] Agent selection controls work
- [ ] Import includes selected agents
- [ ] Import modal shows agent count
- [ ] Agents exist in database after import
</verification>

<success_criteria>
1. FEED-01: Live progress updates via SSE streaming - VERIFIED
2. FEED-02: Discovered items appear incrementally - VERIFIED
3. FEED-03: Elapsed and estimated time displayed - VERIFIED
4. FEED-04: Cancel long-running discovery works - VERIFIED
5. FEED-05: Granular progress shown - VERIFIED
6. AGENT-01 through AGENT-04: Agent detection works - VERIFIED
7. AGENT-05: User can selectively import agents - VERIFIED
8. AGENT-06: Imported agents ready to execute - VERIFIED
</success_criteria>

<output>
After completion, create `.planning/phases/03-real-time-feedback-a-agent-import/03-07-SUMMARY.md`
</output>
