---
phase: 06-agents-management-a-column-automation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/agents/AgentDetailCard.tsx
  - src/lib/db/queries.ts
  - src/app/api/agents/[id]/route.ts
autonomous: true

must_haves:
  truths:
    - "Each agent displays skills it uses, work it can do, jobs it can run"
    - "Agent content is viewable in expanded detail view"
    - "Metadata fields are parsed and displayed"
  artifacts:
    - path: "src/components/agents/AgentDetailCard.tsx"
      provides: "Expanded agent detail view"
      exports: ["AgentDetailCard"]
    - path: "src/app/api/agents/[id]/route.ts"
      provides: "Single agent fetch endpoint"
      exports: ["GET"]
  key_links:
    - from: "src/components/agents/AgentDetailCard.tsx"
      to: "/api/agents/[id]"
      via: "fetch for full agent details"
      pattern: "fetch.*api/agents"
---

<objective>
Enhance agent display to show detailed information including skills used, work capabilities, and associated jobs.

Purpose: Users need to understand what each agent can do before executing it (AGUI-03).

Output: Detailed agent card component with parsed metadata display.
</objective>

<execution_context>
@/Users/tylersahagun/.claude/get-shit-done/workflows/execute-plan.md
@/Users/tylersahagun/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Existing patterns
@src/lib/agents/parser.ts (metadata structure)
@src/lib/db/schema.ts (agentDefinitions metadata field)
@src/app/api/agents/[id]/route.ts (existing endpoint)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AgentDetailCard component</name>
  <files>src/components/agents/AgentDetailCard.tsx</files>
  <action>
Create expanded detail view for agents:

Props:
- agent: AgentDefinition from database
- onClose: () => void

Display sections based on agent type:

**For skills:**
- Triggers section (from metadata.triggers array)
- Workflow steps (from metadata.workflow array)
- Output paths (from metadata.outputPaths array)

**For commands:**
- Usage (from metadata.usage)
- Steps (from metadata.steps array)
- Delegates to (from metadata.delegatesTo)
- Prerequisites (from metadata.prerequisites)

**For subagents:**
- Model (inherit/fast from metadata.model)
- Readonly badge if metadata.readonly
- Context files (from metadata.contextFiles)
- Output paths (from metadata.outputPaths)

**For rules:**
- Globs (from metadata.globs)
- Always apply badge if metadata.alwaysApply

**For agents_md:**
- Show full content in markdown renderer

Use Radix Collapsible for expandable sections.
Style with Tailwind, match existing card patterns from ProjectDetailModal.
  </action>
  <verify>Component renders without errors, displays metadata fields</verify>
  <done>AgentDetailCard shows parsed metadata for each agent type</done>
</task>

<task type="auto">
  <name>Task 2: Update AgentCard to expand to detail view</name>
  <files>
    src/components/agents/AgentCard.tsx
    src/components/agents/index.ts
  </files>
  <action>
Update AgentCard to support expansion:

1. Add isExpanded state and toggle behavior
2. When expanded, render AgentDetailCard inline
3. Add expand/collapse chevron icon
4. Use Framer Motion for smooth height animation

Update index.ts to export AgentDetailCard.
  </action>
  <verify>Click on agent card expands to show detail view</verify>
  <done>Agent cards expand to show detailed information</done>
</task>

<task type="auto">
  <name>Task 3: Ensure API returns full agent data</name>
  <files>src/app/api/agents/[id]/route.ts</files>
  <action>
Verify and update the single agent endpoint:

1. Check existing GET handler returns full agent with metadata
2. Ensure metadata JSONB field is included in response
3. Add proper error handling if agent not found (404)
4. Add permission check using requireWorkspaceAccess

The endpoint already exists but verify it returns complete data including metadata field.
  </action>
  <verify>GET /api/agents/[id] returns agent with metadata field populated</verify>
  <done>API returns complete agent data including parsed metadata</done>
</task>

</tasks>

<verification>
1. Click agent card - expands with animation
2. Skills show triggers, workflow, output paths
3. Commands show usage, steps, delegates to
4. Subagents show model, readonly, context files
5. Rules show globs and always apply status
6. AGENTS.md shows full markdown content
</verification>

<success_criteria>
- AGUI-03: Each agent displays skills it uses, work it can do, jobs it can run
- Metadata parsed and displayed in readable format
- Expandable cards with smooth animation
</success_criteria>

<output>
After completion, create `.planning/phases/06-agents-management-a-column-automation/06-02-SUMMARY.md`
</output>
